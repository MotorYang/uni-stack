<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.github.motoryang.system.modules.relation.mapper.UserDeptMapper">

    <!-- 批量插入用户部门关联 -->
    <insert id="insertBatch">
        INSERT INTO sys_user_dept (id, tenant_id, user_id, dept_id, is_primary, position, create_time, create_by, deleted)
        VALUES
        <foreach collection="list" item="item" separator=",">
            (#{item.id}, #{item.tenantId}, #{item.userId}, #{item.deptId}, #{item.isPrimary}, #{item.position}, #{item.createTime}, #{item.createBy}, 0)
        </foreach>
    </insert>

    <!-- 批量逻辑删除指定部门下的用户关联 -->
    <update id="deleteBatchByDeptIdAndUserIds">
        UPDATE sys_user_dept SET deleted = 1
        WHERE dept_id = #{deptId}
        AND deleted = 0
        AND user_id IN
        <foreach collection="userIds" item="userId" open="(" separator="," close=")">
            #{userId}
        </foreach>
    </update>

</mapper>
